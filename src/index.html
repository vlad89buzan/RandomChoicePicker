<!DOCTYPE html>
<html lang="en">
@@include('html/head.html',{
"title":"Random Choise Picker"
})

<body>
	<div class="wrapper">
		<!-- @@include('html/header.html',{}) -->
		<main>
			<div class="container">
				<h3>Enter all of the choices divided by a coma (',')</h3>
				<p>Press Enter when you're done</p>
				<textarea id="textarea" placeholder="Enter choices here..."></textarea>
				<div id="tags">

				</div>
			</div>


		</main>
		<!-- @@include('html/footer.html',{}) -->
	</div>
	
	<script>
		const tagsEl = document.getElementById('tags');
		const textArea = document.getElementById('textarea');


		textArea.focus();

		textArea.addEventListener('keyup', (e) => {
			createTags(e.target.value);
			if (e.key === 'Enter') {
				setTimeout(() => { e.target.value = '' }, 10)
				randomSelect()
			}
		})

		function createTags(input) {
			const tags = input.split(',').filter(tag => tag.trim() !== '').map(tag => tag.trim());
			console.log(tags);
			tagsEl.innerHTML = '';
			tags.forEach(tag => {
				const tagEl = document.createElement('span');
				tagEl.classList.add('tag');
				tagEl.innerHTML = tag;
				tagsEl.appendChild(tagEl);
			})
		}

		function randomSelect() {
			const times = 30;
			const interval = setInterval(() => {
				const randomTag = pickRandomTag();
				highLightTag(randomTag);

				setTimeout(() => {
					removeHighLightTag(randomTag)
				}, 100)
			}, 100);

			setTimeout(() => {
				clearInterval(interval);
				setTimeout(()=>{
					const randomTag = pickRandomTag();
					highLightTag(randomTag);
				})
			}, times * 100)
		}
		function pickRandomTag() {
			const tags = document.querySelectorAll('.tag');
			return tags[Math.floor(Math.random() * tags.length)];
		}
		function highLightTag(tag) {
			tag.classList.add('highlight')
		}
		function removeHighLightTag(tag) {
			tag.classList.remove('highlight')
		}
	</script>
</body>

</html>